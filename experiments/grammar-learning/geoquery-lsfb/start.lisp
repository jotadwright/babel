(ql:quickload :geoquery-lsfb)
(in-package :geoquery-lsfb)

;(monitors::activate-monitor trace-fcg)

(def-fcg-constructions geoquery-lsfb--grammar
  :feature-types ((subunits set)
                  (args set)
                  (footprints set)
                  (form-args sequence)
                  (form set-of-predicates)
                  (meaning-args sequence)
                  (meaning set-of-predicates))
  :hierarchy-features (subunits)
  :diagnostics ()
  :repairs ()
  :fcg-configurations ((:parse-goal-tests :no-applicable-cxns :connected-semantic-network)
                       (:production-goal-tests :no-applicable-cxns :no-meaning-in-root :connected-structure)
                       (:node-tests :check-duplicate :restrict-nr-of-nodes :restrict-search-depth)
                       (:max-number-of-nodes . 200)
                       (:max-search-depth . 50)
                       (:render-mode . :set-of-predicates) ; set de-render mode to set-of-predicates
                       (:de-render-mode . :set-of-predicates) ; set de-render mode to set-of-predicates
                       (:shuffle-cxns-before-application . t)
                       (:draw-meaning-as-network . t)
                       (:construction-inventory-processor-mode . :heuristic-search)
                       (:node-expansion-mode . :full-expansion)
                       (:search-algorithm . :best-first)
                       (:heuristic-value-mode . :sum-heuristics-and-parent)
                       (:cxn-supplier-mode . :all-cxns)
                       (:heuristics :nr-of-applied-cxns))
  
  :visualization-configurations ((:with-search-debug-data . t)
                                 (:remove-empty-units . nil)
                                 (:show-constructional-dependencies . t)
                                 (:labeled-paths . nil)
                                 (:colored-paths . nil)
                                 (:hide-features . nil)
                                 (:hierarchy-features subunits)
                                 (:selected-hierarchy . subunits)
                                 (:select-subfeatures . nil))
  
  )

; setting handedness configuration
(defparameter *dominant-hand*
  'RH
  ;'LH
  )

;--------------------------------------------------
; Example-1: simple substitution of lexical element
;--------------------------------------------------

;(add-element (slp::represent-signs (slp::xmls->predicates (slp::read-elan "/Users/liesbetdevos/Projects/geoquery-sign/250-dataset/43.highest-mountain/variant-0/43_0_372.eaf"))))

#|
(defparameter *how-long-is-the-delaware-river* '((:form . ((SLP::RIGHT-HAND-ARTICULATION ?PALM-UP-16 PALM-UP)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?RIVIERE.K-31 RIVIERE.K)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?PT-16 PT)
                                                           (SLP::LOCATION ?PT-16 MIDDLE)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?FS\:DELAWARE-16 FS\:DELAWARE)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?DS-31 DS)
                                                           (SLP::LOCATION ?DS-31 MIDDLE)
                                                           (SLP::HANDSHAPE ?DS-31 1)
                                                           (SLP::ORIENTATION ?DS-31 DOWN-OUT)
                                                           (SLP::MOVEMENT ?DS-31 IN-OUT)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?COMBIEN-16 COMBIEN)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?KILOMETRE-16 KILOMETRE)
                                                           (SLP::LEFT-HAND-ARTICULATION ?RIVIERE.K-32 RIVIERE.K)
                                                           (SLP::LEFT-HAND-ARTICULATION ?DS-32 DS)
                                                           (SLP::LOCATION ?DS-32 MIDDLE)
                                                           (SLP::HANDSHAPE ?DS-32 1)
                                                           (SLP::ORIENTATION ?DS-32 RIGHT-OUT)
                                                           (MEETS ?PALM-UP-16 ?RIVIERE.K-31)
                                                           (MEETS ?RIVIERE.K-31 ?PT-16)
                                                           (MEETS ?PT-16 ?FS\:DELAWARE-16)
                                                           (MEETS ?FS\:DELAWARE-16 ?DS-31)
                                                           (MEETS ?DS-31 ?COMBIEN-16)
                                                           (MEETS ?COMBIEN-16 ?KILOMETRE-16)
                                                           (MEETS ?PALM-UP-16 ?RIVIERE.K-32)
                                                           (SLP::COINCIDES-RELATION ?RIVIERE.K-31 ?RIVIERE.K-32 EQUALS)
                                                           (SLP::MEETS ?FS\:DELAWARE-16 ?DS-32)
                                                           (SLP::COINCIDES-RELATION ?DS-31 ?DS-32 EQUALS)))
                                                 (:meaning . ((ANSWER ?C ?A ?D)
                                                              (LEN ?D ?B ?A)
                                                              (CONST ?D ?B ?E)
                                                              (RIVERID ?E ?F)
                                                              (DELAWARE ?F)
                                                              (RIVER ?D ?B)))))

(defparameter *how-long-is-the-missouri-river* '((:form . ((SLP::RIGHT-HAND-ARTICULATION ?PALM-UP-17 PALM-UP)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?RIVIERE.K-33 RIVIERE.K)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?PT-17 PT)
                                                           (SLP::LOCATION ?PT-17 MIDDLE)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?FS\:MISSOURI-1 FS\:MISSOURI)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?DS-33 DS)
                                                           (SLP::LOCATION ?DS-33 MIDDLE)
                                                           (SLP::HANDSHAPE ?DS-33 1)
                                                           (SLP::ORIENTATION ?DS-33 DOWN-OUT)
                                                           (SLP::MOVEMENT ?DS-33 IN-OUT)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?COMBIEN-17 COMBIEN)
                                                           (SLP::RIGHT-HAND-ARTICULATION ?KILOMETRE-17 KILOMETRE)
                                                           (SLP::LEFT-HAND-ARTICULATION ?RIVIERE.K-34 RIVIERE.K)
                                                           (SLP::LEFT-HAND-ARTICULATION ?DS-34 DS)
                                                           (SLP::LOCATION ?DS-34 MIDDLE)
                                                           (SLP::HANDSHAPE ?DS-34 1)
                                                           (SLP::ORIENTATION ?DS-34 RIGHT-OUT)
                                                           (MEETS ?PALM-UP-17 ?RIVIERE.K-33)
                                                           (MEETS ?RIVIERE.K-33 ?PT-17)
                                                           (MEETS ?PT-17 ?FS\:MISSOURI-1)
                                                           (MEETS ?FS\:MISSOURI-1 ?DS-33)
                                                           (MEETS ?DS-33 ?COMBIEN-17)
                                                           (MEETS ?COMBIEN-17 ?KILOMETRE-17)
                                                           (MEETS ?PALM-UP-17 ?RIVIERE.K-34)
                                                           (SLP::COINCIDES-RELATION ?RIVIERE.K-33 ?RIVIERE.K-34 EQUALS)
                                                           (SLP::MEETS ?FS\:MISSOURI-1 ?DS-34)
                                                           (SLP::COINCIDES-RELATION ?DS-33 ?DS-34 EQUALS)))
                                                 (:meaning . ((ANSWER ?C ?A ?D)
                                                              (LEN ?D ?B ?A)
                                                              (CONST ?D ?B ?E)
                                                              (RIVERID ?E ?F)
                                                              (MISSOURI ?F)
                                                              (RIVER ?D ?B)))))

; 1. learn a holophrastic construction for one of the observations:

;(defparameter *how-long-is-the-delaware-river-holophrastic-cxn* (induce-cxns *how-long-is-the-delaware-river* nil :cxn-inventory *fcg-constructions*))


; 2. use induce-cxns to learn a slot-cxn and a filler construction by comparing the holophrastic-cxn with a new observation.

;(induce-cxns *how-long-is-the-missouri-river* *how-long-is-the-delaware-river-holophrastic-cxn*)


; Comparing exhaustive unification with one-stable k-swap algorithm:

 
(time (anti-unify-predicate-network
       (cdr (assoc :form *how-long-is-the-delaware-river*))
       (cdr (assoc :form *how-long-is-the-missouri-river*))))

; --> computing time of around 12 minutes

(time (au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *how-long-is-the-delaware-river*))
                                                              (cdr (assoc :form *how-long-is-the-missouri-river*))
                                                              :mode :shared-bindings)))


; --> computing time of 0.57 seconds
                              
; Check whether the two solutions are equivalent (which they are):
(equivalent-irl-programs? '((right-hand-articulation ?r-50646 kilometre)
                            (right-hand-articulation ?s-50646 combien)
                            (right-hand-articulation ?t-50646 palm-up)
                            (meets ?s-50646 ?r-50646)
                            (left-hand-articulation ?u-50646 riviere.k)
                            (right-hand-articulation ?v-50646 pt)
                            (meets ?t-50646 ?u-50646)
                            (right-hand-articulation ?w-50646 riviere.k)
                            (meets ?t-50646 ?w-50646)
                            (meets ?v-50646 ?x-50646)
                            (location ?v-50646 middle)
                            (orientation ?y-50646 right-out)
                            (coincides-relation ?w-50646 ?u-50646 equals)
                            (meets ?w-50646 ?v-50646)
                            (left-hand-articulation ?y-50646 ds)
                            (handshape ?y-50646 1)
                            (meets ?x-50646 ?y-50646)
                            (location ?y-50646 middle)
                            (movement ?z-50646 in-out)
                            (orientation ?z-50646 down-out)
                            (right-hand-articulation ?z-50646 ds)
                            (handshape ?z-50646 1)
                            (meets ?z-50646 ?s-50646)
                            (meets ?x-50646 ?z-50646)
                            (location ?z-50646 middle)
                            (coincides-relation ?z-50646 ?y-50646 equals))
                          '((RIGHT-HAND-ARTICULATION ?W-943754 GEOQUERY-LSFB::PALM-UP)
                            (RIGHT-HAND-ARTICULATION ?X-943777 GEOQUERY-LSFB::RIVIERE.K)
                            (RIGHT-HAND-ARTICULATION ?Y-943755 GEOQUERY-LSFB::PT)
                            (LOCATION ?Y-943755 GEOQUERY-LSFB::MIDDLE)
                            (RIGHT-HAND-ARTICULATION ?Z-944010 GEOQUERY-LSFB::DS)
                            (LOCATION ?Z-944010 GEOQUERY-LSFB::MIDDLE)
                            (HANDSHAPE ?Z-944010 1)
                            (UTILS:ORIENTATION ?Z-944010 GEOQUERY-LSFB::DOWN-OUT)
                            (MOVEMENT ?Z-944010 GEOQUERY-LSFB::IN-OUT)
                            (RIGHT-HAND-ARTICULATION ?A-944769 GEOQUERY-LSFB::COMBIEN)
                            (RIGHT-HAND-ARTICULATION ?B-944321 GEOQUERY-LSFB::KILOMETRE)
                            (LEFT-HAND-ARTICULATION ?C-944193 GEOQUERY-LSFB::RIVIERE.K)
                            (LEFT-HAND-ARTICULATION ?D-944449 GEOQUERY-LSFB::DS)
                            (LOCATION ?D-944449 GEOQUERY-LSFB::MIDDLE)
                            (HANDSHAPE ?D-944449 1)
                            (UTILS:ORIENTATION ?D-944449 GEOQUERY-LSFB::RIGHT-OUT)
                            (MEETS ?W-943754 ?X-943777)
                            (MEETS ?X-943777 ?Y-943755)
                            (MEETS ?Y-943755 ?E-944001)
                            (MEETS ?E-944001 ?Z-944010)
                            (MEETS ?Z-944010 ?A-944769)
                            (MEETS ?A-944769 ?B-944321)
                            (MEETS ?W-943754 ?C-944193)
                            (COINCIDES-RELATION ?X-943777 ?C-944193 GEOQUERY-LSFB::EQUALS)
                            (MEETS ?E-944001 ?D-944449)
                            (COINCIDES-RELATION ?Z-944010 ?D-944449 GEOQUERY-LSFB::EQUALS)))


;-----------------------------------------------
; Example 2: substitution including classifiers
;------------------------------------------------

(defparameter *give-me-rivers-in-virginia* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-1 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?PT-18 PT)
                                                       (LOCATION ?PT-18 LEFT)
                                                       (RIGHT-HAND-ARTICULATION ?FS\:VIRGINIE-1 FS\:VIRGINIE)
                                                       (RIGHT-HAND-ARTICULATION ?IL-Y-A-1 IL-Y-A)
                                                       (RIGHT-HAND-ARTICULATION ?DANS-2 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?RIVIERE.K-35 RIVIERE.K)
                                                       (RIGHT-HAND-ARTICULATION ?PT-19 PT)
                                                       (LOCATION ?PT-19 LEFT)
                                                       (RIGHT-HAND-ARTICULATION ?QUOI-1 QUOI)
                                                       (RIGHT-HAND-ARTICULATION ?ME-DIRE-1 ME-DIRE)
                                                       (RIGHT-HAND-ARTICULATION ?NOM.1-1 NOM.1)
                                                       (RIGHT-HAND-ARTICULATION ?QUOI-2 QUOI)
                                                       (LEFT-HAND-ARTICULATION ?DANS-3 DANS)
                                                       (LEFT-HAND-ARTICULATION ?DANS-4 DANS)
                                                       (LEFT-HAND-ARTICULATION ?RIVIERE.K-36 RIVIERE.K)
                                                       (MEETS ?DANS-1 ?PT-18)
                                                       (MEETS ?PT-18 ?FS\:VIRGINIE-1)
                                                       (MEETS ?FS\:VIRGINIE-1 ?IL-Y-A-1)
                                                       (MEETS ?IL-Y-A-1 ?DANS-2)
                                                       (MEETS ?DANS-2 ?RIVIERE.K-35)
                                                       (MEETS ?RIVIERE.K-35 ?PT-19)
                                                       (MEETS ?PT-19 ?QUOI-1)
                                                       (MEETS ?QUOI-1 ?ME-DIRE-1)
                                                       (MEETS ?ME-DIRE-1 ?NOM.1-1)
                                                       (MEETS ?NOM.1-1 ?QUOI-2)
                                                       (COINCIDES-RELATION ?DANS-1 ?DANS-3 EQUALS)
                                                       (MEETS ?IL-Y-A-1 ?DANS-4)
                                                       (COINCIDES-RELATION ?DANS-2 ?DANS-4 EQUALS)
                                                       (MEETS ?DANS-2 ?RIVIERE.K-36)
                                                       (COINCIDES-RELATION ?RIVIERE.K-35 ?RIVIERE.K-36 EQUALS)))
                                             (:meaning . ((ANSWER ?C ?A ?D)
                                                          (RIVER ?D ?A)
                                                          (LOC ?D ?A ?B)
                                                          (CONST ?D ?B ?E)
                                                          (STATEID ?E ?F)
                                                          (VIRGINIA ?F)))))

(defparameter *give-me-cities-in-virginia* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-5 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?PT-20 PT)
                                                       (LOCATION ?PT-20 LEFT)
                                                       (HANDSHAPE ?PT-20 5)
                                                       (ORIENTATION ?PT-20 DOWN-UP)
                                                       (MOVEMENT ?PT-20 CIRCLE)
                                                       (RIGHT-HAND-ARTICULATION ?FS\:VIRGINIE-2 FS\:VIRGINIE)
                                                       (RIGHT-HAND-ARTICULATION ?DANS-6 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?IL-Y-A-2 IL-Y-A)
                                                       (RIGHT-HAND-ARTICULATION ?VILLE-1 VILLE)
                                                       (RIGHT-HAND-ARTICULATION ?QUOI-3 QUOI)
                                                       (RIGHT-HAND-ARTICULATION ?PALM-UP-18 PALM-UP)
                                                       (RIGHT-HAND-ARTICULATION ?ME-DIRE-2 ME-DIRE)
                                                       (MODIFICATION ?ME-DIRE-2 REDUPLICATED)
                                                       (LEFT-HAND-ARTICULATION ?DANS-7 DANS)
                                                       (LEFT-HAND-ARTICULATION ?DS-35 DS)
                                                       (LOCATION ?DS-35 LEFT)
                                                       (HANDSHAPE ?DS-35 7)
                                                       (ORIENTATION ?DS-35 DOWN-UP)
                                                       (LEFT-HAND-ARTICULATION ?DANS-8 DANS)
                                                       (LEFT-HAND-ARTICULATION ?VILLE-2 VILLE)
                                                       (LEFT-HAND-ARTICULATION ?ME-DIRE-3 ME-DIRE)
                                                       (MODIFICATION ?ME-DIRE-3 REDUPLICATED)
                                                       (MEETS ?DANS-5 ?PT-20)
                                                       (MEETS ?PT-20 ?FS\:VIRGINIE-2)
                                                       (MEETS ?FS\:VIRGINIE-2 ?DANS-6)
                                                       (MEETS ?DANS-6 ?IL-Y-A-2)
                                                       (MEETS ?IL-Y-A-2 ?VILLE-1)
                                                       (MEETS ?VILLE-1 ?QUOI-3)
                                                       (MEETS ?QUOI-3 ?PALM-UP-18)
                                                       (MEETS ?PALM-UP-18 ?ME-DIRE-2)
                                                       (COINCIDES-RELATION ?DANS-5 ?DANS-7 EQUALS)
                                                       (MEETS ?DANS-5 ?DS-35)
                                                       (COINCIDES-RELATION ?PT-20 ?DS-35 EQUALS)
                                                       (MEETS ?FS\:VIRGINIE-2 ?DANS-8)
                                                       (COINCIDES-RELATION ?DANS-6 ?DANS-8 EQUALS)
                                                       (MEETS ?IL-Y-A-2 ?VILLE-2)
                                                       (COINCIDES-RELATION ?VILLE-1 ?VILLE-2 EQUALS)
                                                       (MEETS ?PALM-UP-18 ?ME-DIRE-3)
                                                       (COINCIDES-RELATION ?ME-DIRE-2 ?ME-DIRE-3 EQUALS)))
                                                 (:meaning . ((ANSWER ?C ?A ?D)
                                                              (CITY ?D ?A)
                                                              (LOC ?D ?A ?B)
                                                              (CONST ?D ?B ?E)
                                                              (STATEID ?E ?F)
                                                              (VIRGINIA ?F)))))



(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *give-me-rivers-in-virginia*))
                                                              (cdr (assoc :form *give-me-cities-in-virginia*))
                                                              :mode :shared-bindings))

; --> there is a difference in the way the question is expressed, so parts that should be part of the generalization are part of the delta of one of the observations. We could solve this by synthetically providing other observations that have the same overall structure (except for information that should be in the delta's). However, it seems in general that there might be some relaxations in sign language on word order or adding small signs like pointing signs (these signs will not change the meaning of the utterance)

; Example of synthetically created observations:


(au-benchmark.msg.kswap-omega::print-anti-unification-results
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks '((RIGHT-HAND-ARTICULATION ?DANS-1 DANS)
                                                                (RIGHT-HAND-ARTICULATION ?PT-18 PT)
                                                                (LOCATION ?PT-18 LEFT)
                                                                (RIGHT-HAND-ARTICULATION ?FS\:VIRGINIE-1 FS\:VIRGINIE)
                                                                (RIGHT-HAND-ARTICULATION ?IL-Y-A-1 IL-Y-A)
                                                                (RIGHT-HAND-ARTICULATION ?DANS-2 DANS)
                                                                (RIGHT-HAND-ARTICULATION ?RIVIERE.K-35 RIVIERE.K)
                                                                (RIGHT-HAND-ARTICULATION ?PT-19 PT)
                                                                (LOCATION ?PT-19 LEFT)
                                                                (RIGHT-HAND-ARTICULATION ?QUOI-1 QUOI)
                                                                (RIGHT-HAND-ARTICULATION ?ME-DIRE-1 ME-DIRE)
                                                                (RIGHT-HAND-ARTICULATION ?NOM.1-1 NOM.1)
                                                                (RIGHT-HAND-ARTICULATION ?QUOI-2 QUOI)
                                                                (LEFT-HAND-ARTICULATION ?DANS-3 DANS)
                                                                (LEFT-HAND-ARTICULATION ?DANS-4 DANS)
                                                                (LEFT-HAND-ARTICULATION ?RIVIERE.K-36 RIVIERE.K)
                                                                ;(MEETS ?DANS-1 ?PT-18)
                                                                ;(MEETS ?PT-18 ?FS\:VIRGINIE-1)
                                                                ;(MEETS ?FS\:VIRGINIE-1 ?IL-Y-A-1)
                                                                ;(MEETS ?IL-Y-A-1 ?DANS-2)
                                                                ;(MEETS ?DANS-2 ?RIVIERE.K-35)
                                                                ;(MEETS ?RIVIERE.K-35 ?PT-19)
                                                                ;(MEETS ?PT-19 ?QUOI-1)
                                                                ;(MEETS ?QUOI-1 ?ME-DIRE-1)
                                                                ;(MEETS ?ME-DIRE-1 ?NOM.1-1)
                                                                ;(MEETS ?NOM.1-1 ?QUOI-2)
                                                                (COINCIDES-RELATION ?DANS-1 ?DANS-3 EQUALS)
                                                                ;(MEETS ?IL-Y-A-1 ?DANS-4)
                                                                (COINCIDES-RELATION ?DANS-2 ?DANS-4 EQUALS)
                                                                ;(MEETS ?DANS-2 ?RIVIERE.K-36)
                                                                (COINCIDES-RELATION ?RIVIERE.K-35 ?RIVIERE.K-36 EQUALS))
                                                              '((RIGHT-HAND-ARTICULATION ?DANS-1 DANS)
                                                                (RIGHT-HAND-ARTICULATION ?PT-18 PT)
                                                                (LOCATION ?PT-18 LEFT)
                                                                (RIGHT-HAND-ARTICULATION ?FS\:VIRGINIE-1 FS\:VIRGINIE)
                                                                (RIGHT-HAND-ARTICULATION ?IL-Y-A-1 IL-Y-A)
                                                                (RIGHT-HAND-ARTICULATION ?DANS-2 DANS)
                                                                (RIGHT-HAND-ARTICULATION ?VILLE-35 VILLE)
                                                                (RIGHT-HAND-ARTICULATION ?PT-19 PT)
                                                                (LOCATION ?PT-19 LEFT)
                                                                (RIGHT-HAND-ARTICULATION ?QUOI-1 QUOI)
                                                                (RIGHT-HAND-ARTICULATION ?ME-DIRE-1 ME-DIRE)
                                                                (RIGHT-HAND-ARTICULATION ?NOM.1-1 NOM.1)
                                                                (RIGHT-HAND-ARTICULATION ?QUOI-2 QUOI)
                                                                (LEFT-HAND-ARTICULATION ?DANS-3 DANS)
                                                                (LEFT-HAND-ARTICULATION ?DANS-4 DANS)
                                                                (LEFT-HAND-ARTICULATION ?VILLE-36 VILLE)
                                                                ;(MEETS ?DANS-1 ?PT-18)
                                                                ;(MEETS ?PT-18 ?FS\:VIRGINIE-1)
                                                                ;(MEETS ?FS\:VIRGINIE-1 ?IL-Y-A-1)
                                                                ;(MEETS ?IL-Y-A-1 ?DANS-2)
                                                                ;(MEETS ?DANS-2 ?VILLE-35)
                                                                ;(MEETS ?VILLE-35 ?PT-19)
                                                                ;(MEETS ?PT-19 ?QUOI-1)
                                                                ;(MEETS ?QUOI-1 ?ME-DIRE-1)
                                                                ;(MEETS ?ME-DIRE-1 ?NOM.1-1)
                                                                ;(MEETS ?NOM.1-1 ?QUOI-2)
                                                                (COINCIDES-RELATION ?DANS-1 ?DANS-3 EQUALS)
                                                                ;(MEETS ?IL-Y-A-1 ?DANS-4)
                                                                (COINCIDES-RELATION ?DANS-2 ?DANS-4 EQUALS)
                                                                ;(MEETS ?DANS-2 ?VILLE-36)
                                                                (COINCIDES-RELATION ?VILLE-35 ?VILLE-36 EQUALS)):mode :shared-bindings))


;---------------------
; Example 3: Addition
;---------------------

(defparameter *neighbouring-states-of-mississippi* '((:form . ((RIGHT-HAND-ARTICULATION ?PT-1 PT)
                                                               (LOCATION ?PT-1 LEFT)
                                                               (RIGHT-HAND-ARTICULATION ?FS\:MISSISSIPPI-1 FS\:MISSISSIPPI)
                                                               (RIGHT-HAND-ARTICULATION ?IL-Y-A-1 IL-Y-A)
                                                               (RIGHT-HAND-ARTICULATION ?DS-1 DS)
                                                               (LOCATION ?DS-1 LEFT)
                                                               (HANDSHAPE ?DS-1 BENT5)
                                                               (ORIENTATION ?DS-1 DOWN-OUT)
                                                               (MOVEMENT ?DS-1 UP-DOWN)
                                                               (RIGHT-HAND-ARTICULATION ?PT-2 PT)
                                                               (LOCATION ?PT-2 LEFT)
                                                               (RIGHT-HAND-ARTICULATION ?ME-DIRE-1 ME-DIRE)
                                                               (RIGHT-HAND-ARTICULATION ?QUOI-1 QUOI)
                                                               (RIGHT-HAND-ARTICULATION ?NOM.1-1 NOM.1)
                                                               (RIGHT-HAND-ARTICULATION ?PT-3 PT)
                                                               (MODIFICATION ?PT-3 REDUPLICATED)
                                                               (LOCATION ?PT-3 LEFT)
                                                               (LEFT-HAND-ARTICULATION ?DS-2 DS)
                                                               (LOCATION ?DS-2 LEFT)
                                                               (HANDSHAPE ?DS-2 BENT5)
                                                               (ORIENTATION ?DS-2 DOWN-OUT)
                                                               (MOVEMENT ?DS-2 UP-DOWN)
                                                               (LEFT-HAND-ARTICULATION ?NOM.1-2 NOM.1)
                                                               (LEFT-HAND-ARTICULATION ?DS-3 DS)
                                                               (LOCATION ?DS-3 LEFT)
                                                               (HANDSHAPE ?DS-3 BENT5)
                                                               (ORIENTATION ?DS-3 DOWN-OUT)
                                                               (MEETS ?PT-1 ?FS\:MISSISSIPPI-1)
                                                               (MEETS ?FS\:MISSISSIPPI-1 ?IL-Y-A-1)
                                                               (MEETS ?IL-Y-A-1 ?DS-1)
                                                               (MEETS ?DS-1 ?PT-2)
                                                               (MEETS ?PT-2 ?ME-DIRE-1)
                                                               (MEETS ?ME-DIRE-1 ?QUOI-1)
                                                               (MEETS ?QUOI-1 ?NOM.1-1)
                                                               (MEETS ?NOM.1-1 ?PT-3)
                                                               (MEETS ?FS\:MISSISSIPPI-1 ?DS-2)
                                                               (COINCIDES-RELATION ?IL-Y-A-1 ?DS-2 STARTS)
                                                               (COINCIDES-RELATION ?DS-1 ?DS-2 DURING)
                                                               (COINCIDES-RELATION ?PT-2 ?DS-2 DURING)
                                                               (COINCIDES-RELATION ?ME-DIRE-1 ?DS-2 DURING)
                                                               (COINCIDES-RELATION ?QUOI-1 ?DS-2 FINISHES)
                                                               (MEETS ?QUOI-1 ?NOM.1-2)
                                                               (COINCIDES-RELATION ?NOM.1-1 ?NOM.1-2 EQUALS)
                                                               (MEETS ?NOM.1-1 ?DS-3)
                                                               (COINCIDES-RELATION ?PT-3 ?DS-3 EQUALS)))
                                             (:meaning . ((ANSWER ?C ?A ?D)
                                                          (STATE ?D ?A)
                                                          (NEXT_TO ?D ?A ?B)
                                                          (CONST ?D ?B ?E)
                                                          (STATEID ?E ?F)
                                                          (MISSISSIPPI ?F)))))

(defparameter *highest-point-in-neighbouring-states-mississippi* '((:form . ((RIGHT-HAND-ARTICULATION ?PALM-UP-3 PALM-UP)
                                                                          (RIGHT-HAND-ARTICULATION ?DANS-3 DANS)
                                                                          (RIGHT-HAND-ARTICULATION ?FS\:MISSISSIPPI-2 FS\:MISSISSIPPI)
                                                                          (RIGHT-HAND-ARTICULATION ?IL-Y-A-3 IL-Y-A)
                                                                          (RIGHT-HAND-ARTICULATION ?DS-6 DS)
                                                                          (MODIFICATION ?DS-6 REDUPLICATED)
                                                                          (LOCATION ?DS-6 LEFT)
                                                                          (HANDSHAPE ?DS-6 BENT5)
                                                                          (ORIENTATION ?DS-6 DOWN-OUT)
                                                                          (MOVEMENT ?DS-6 UP-DOWN)
                                                                          (RIGHT-HAND-ARTICULATION ?PT-5 PT)
                                                                          (LOCATION ?PT-5 LEFT)
                                                                          (MOVEMENT ?PT-5 CIRCLE)
                                                                          (RIGHT-HAND-ARTICULATION ?HAUT-2 HAUT)
                                                                          (RIGHT-HAND-ARTICULATION ?QUOI-3 QUOI)
                                                                          (LEFT-HAND-ARTICULATION ?PALM-UP-4 PALM-UP)
                                                                          (LEFT-HAND-ARTICULATION ?DANS-4 DANS)
                                                                          (LEFT-HAND-ARTICULATION ?DS-7 DS)
                                                                          (LOCATION ?DS-7 LEFT)
                                                                          (HANDSHAPE ?DS-7 BENT5)
                                                                          (ORIENTATION ?DS-7 DOWN-OUT)
                                                                          (MEETS ?PALM-UP-3 ?DANS-3)
                                                                          (MEETS ?DANS-3 ?FS\:MISSISSIPPI-2)
                                                                          (MEETS ?FS\:MISSISSIPPI-2 ?IL-Y-A-3)
                                                                          (MEETS ?IL-Y-A-3 ?DS-6)
                                                                          (MEETS ?DS-6 ?PT-5)
                                                                          (MEETS ?PT-5 ?HAUT-2)
                                                                          (MEETS ?HAUT-2 ?QUOI-3)
                                                                          (COINCIDES-RELATION ?PALM-UP-3 ?PALM-UP-4 EQUALS)
                                                                          (MEETS ?PALM-UP-3 ?DANS-4)
                                                                          (COINCIDES-RELATION ?DANS-3 ?DANS-4 EQUALS)
                                                                          (MEETS ?IL-Y-A-3 ?DS-7)
                                                                          (COINCIDES-RELATION ?DS-6 ?DS-7 STARTS)
                                                                          (COINCIDES-RELATION ?PT-5 ?DS-7 DURING)
                                                                          (COINCIDES-RELATION ?HAUT-2 ?DS-7 FINISHES)))
                                                 (:meaning . ((ANSWER ?D ?A ?E)
                                                              (HIGH_POINT ?E ?B ?A)
                                                              (STATE ?E ?B)
                                                              (NEXT_TO ?E ?B ?C)
                                                              (CONST ?E ?C ?F)
                                                              (STATEID ?F ?G)
                                                              (MISSISSIPPI ?G)))))


(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *neighbouring-states-of-mississippi*))
                                                              (cdr (assoc :form  *highest-point-in-neighbouring-states-mississippi*))
                                                              :mode :shared-bindings))


;-------------------------
; Example 4: Substitution
;-------------------------

(defparameter *elevation-highest-point-us* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-5 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?NS\:AMERIQUE.LAVER-VISAGE-1 NS\:AMERIQUE.LAVER-VISAGE)
                                                       (RIGHT-HAND-ARTICULATION ?PT-6 PT)
                                                       (LOCATION ?PT-6 MIDDLE)
                                                       (HANDSHAPE ?PT-6 \5)
                                                       (ORIENTATION ?PT-6 DOWN-UP)
                                                       (MOVEMENT ?PT-6 LEFT-RIGHT)
                                                       (RIGHT-HAND-ARTICULATION ?PT-7 PT)
                                                       (LOCATION ?PT-7 MIDDLE)
                                                       (MOVEMENT ?PT-7 LEFT-RIGHT)
                                                       (RIGHT-HAND-ARTICULATION ?PT-8 PT)
                                                       (LOCATION ?PT-8 MIDDLE)
                                                       (RIGHT-HAND-ARTICULATION ?PLUS.P-1 PLUS.P)
                                                       (RIGHT-HAND-ARTICULATION ?HAUT-3 HAUT)
                                                       (RIGHT-HAND-ARTICULATION ?PT-9 PT)
                                                       (LOCATION ?PT-9 MIDDLE)
                                                       (RIGHT-HAND-ARTICULATION ?COMBIEN-1 COMBIEN)
                                                       (RIGHT-HAND-ARTICULATION ?METRE-1 METRE)
                                                       (RIGHT-HAND-ARTICULATION ?PT-10 PT)
                                                       (LOCATION ?PT-10 RIGHT)
                                                       (LEFT-HAND-ARTICULATION ?DANS-6 DANS)
                                                       (LEFT-HAND-ARTICULATION ?DS-8 DS)
                                                       (LOCATION ?DS-8 MIDDLE)
                                                       (HANDSHAPE ?DS-8 \7)
                                                       (ORIENTATION ?DS-8 DOWN-UP)
                                                       (LEFT-HAND-ARTICULATION ?METRE-2 METRE)
                                                       (MEETS ?DANS-5 ?NS\:AMERIQUE.LAVER-VISAGE-1)
                                                       (MEETS ?NS\:AMERIQUE.LAVER-VISAGE-1 ?PT-6)
                                                       (MEETS ?PT-6 ?PT-7)
                                                       (MEETS ?PT-7 ?PT-8)
                                                       (MEETS ?PT-8 ?PLUS.P-1)
                                                       (MEETS ?PLUS.P-1 ?HAUT-3)
                                                       (MEETS ?HAUT-3 ?PT-9)
                                                       (MEETS ?PT-9 ?COMBIEN-1)
                                                       (MEETS ?COMBIEN-1 ?METRE-1)
                                                       (MEETS ?METRE-1 ?PT-10)
                                                       (COINCIDES-RELATION ?DANS-5 ?DANS-6 EQUALS)
                                                       (MEETS ?NS\:AMERIQUE.LAVER-VISAGE-1 ?DS-8)
                                                       (COINCIDES-RELATION ?PT-6 ?DS-8 STARTS)
                                                       (COINCIDES-RELATION ?PT-7 ?DS-8 DURING)
                                                       (COINCIDES-RELATION ?PT-8 ?DS-8 DURING)
                                                       (COINCIDES-RELATION ?PLUS.P-1 ?DS-8 DURING)
                                                       (COINCIDES-RELATION ?HAUT-3 ?DS-8 FINISHES)
                                                       (MEETS ?COMBIEN-1 ?METRE-2)
                                                       (COINCIDES-RELATION ?METRE-1 ?METRE-2 EQUALS)))
                                             (:meaning . ((ANSWER ?D ?A ?E)
                                                          (ELEVATION ?E ?B ?A)
                                                          (HIGHEST ?E ?B ?F)
                                                          (PLACE ?F ?B)
                                                          (LOC ?F ?B ?C)
                                                          (CONST ?F ?C ?G)
                                                          (COUNTRYID ?G ?H)
                                                          (USA ?H)))))

(defparameter *elevation-highest-point-montana* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-13 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?PT-24 PT)
                                                       (LOCATION ?PT-24 LEFT)
                                                       (RIGHT-HAND-ARTICULATION ?DS-13 DS)
                                                       (LOCATION ?DS-13 LEFT)
                                                       (HANDSHAPE ?DS-13 BENT5)
                                                       (ORIENTATION ?DS-13 DOWN-RIGHT)
                                                       (RIGHT-HAND-ARTICULATION ?FS\:MONTANA-2 FS\:MONTANA)
                                                       (RIGHT-HAND-ARTICULATION ?PT-25 PT)
                                                       (LOCATION ?PT-25 LEFT)
                                                       (RIGHT-HAND-ARTICULATION ?PLUS.P-5 PLUS.P)
                                                       (RIGHT-HAND-ARTICULATION ?HAUT-7 HAUT)
                                                       (RIGHT-HAND-ARTICULATION ?COMBIEN-5 COMBIEN)
                                                       (RIGHT-HAND-ARTICULATION ?METRE-9 METRE)
                                                       (RIGHT-HAND-ARTICULATION ?PT-26 PT)
                                                       (LOCATION ?PT-26 LEFT)
                                                       (LEFT-HAND-ARTICULATION ?DANS-14 DANS)
                                                       (LEFT-HAND-ARTICULATION ?DS-14 DS)
                                                       (LOCATION ?DS-14 LEFT)
                                                       (HANDSHAPE ?DS-14 BA)
                                                       (ORIENTATION ?DS-14 LEFT-OUT)
                                                       (LEFT-HAND-ARTICULATION ?METRE-10 METRE)
                                                       (MEETS ?DANS-13 ?PT-24)
                                                       (MEETS ?PT-24 ?DS-13)
                                                       (MEETS ?DS-13 ?FS\:MONTANA-2)
                                                       (MEETS ?FS\:MONTANA-2 ?PT-25)
                                                       (MEETS ?PT-25 ?PLUS.P-5)
                                                       (MEETS ?PLUS.P-5 ?HAUT-7)
                                                       (MEETS ?HAUT-7 ?COMBIEN-5)
                                                       (MEETS ?COMBIEN-5 ?METRE-9)
                                                       (MEETS ?METRE-9 ?PT-26)
                                                       (COINCIDES-RELATION ?DANS-13 ?DANS-14 EQUALS)
                                                       (MEETS ?PLUS.P-5 ?DS-14)
                                                       (COINCIDES-RELATION ?HAUT-7 ?DS-14 EQUALS)
                                                       (MEETS ?COMBIEN-5 ?METRE-10)
                                                       (COINCIDES-RELATION ?METRE-9 ?METRE-10 EQUALS)))
                                             (:meaning . ((ANSWER ?D ?A ?E)
                                                          (ELEVATION ?E ?B ?A)
                                                          (HIGHEST ?E ?B ?F)
                                                          (PLACE ?F ?B)
                                                          (LOC ?F ?B ?C)
                                                          (CONST ?F ?C ?G)
                                                          (STATEID ?G ?H)
                                                          (MONTANA ?H)))))
(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *elevation-highest-point-us*))
                                                              (cdr (assoc :form  *elevation-highest-point-montana*))
                                                              :mode :shared-bindings))

;-------------------------
; Example 5: Addition
;-------------------------

(defparameter *size-of-texas* '((:form . ((RIGHT-HAND-ARTICULATION ?PT-27 PT)
                                          (LOCATION ?PT-27 LEFT)
                                          (HANDSHAPE ?PT-27 \5)
                                          (ORIENTATION ?PT-27 DOWN-UP)
                                          (MOVEMENT ?PT-27 CIRCLE)
                                          (RIGHT-HAND-ARTICULATION ?NS\:TEXAS-1 NS\:TEXAS)
                                          (RIGHT-HAND-ARTICULATION ?PT-28 PT)
                                          (LOCATION ?PT-28 LEFT)
                                          (RIGHT-HAND-ARTICULATION ?TAILLEUR-2 TAILLEUR)
                                          (RIGHT-HAND-ARTICULATION ?COMBIEN-6 COMBIEN)
                                          (RIGHT-HAND-ARTICULATION ?PT-29 PT)
                                          (LOCATION ?PT-29 LEFT)
                                          (LEFT-HAND-ARTICULATION ?DS-15 DS)
                                          (LOCATION ?DS-15 LEFT)
                                          (HANDSHAPE ?DS-15 \7)
                                          (ORIENTATION ?DS-15 DOWN-UP)
                                          (LEFT-HAND-ARTICULATION ?TAILLEUR-1 TAILLEUR)
                                          (MEETS ?PT-27 ?NS\:TEXAS-1)
                                          (MEETS ?NS\:TEXAS-1 ?PT-28)
                                          (MEETS ?PT-28 ?TAILLEUR-2)
                                          (MEETS ?TAILLEUR-2 ?COMBIEN-6)
                                          (MEETS ?COMBIEN-6 ?PT-29)
                                          (COINCIDES-RELATION ?PT-27 ?DS-15 STARTS)
                                          (COINCIDES-RELATION ?NS\:TEXAS-1 ?DS-15 DURING)
                                          (COINCIDES-RELATION ?PT-28 ?DS-15 FINISHES)
                                          (MEETS ?PT-28 ?TAILLEUR-1)
                                          (COINCIDES-RELATION ?TAILLEUR-2 ?TAILLEUR-1 EQUALS)))
                                (:meaning . ((ANSWER ?C ?A ?D)
                                             (SIZE ?D ?B ?A)
                                             (CONST ?D ?B ?E)
                                             (STATEID ?E ?F)
                                             (TEXAS ?F)))))

(defparameter *size-of-largest-city-texas* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-15 DANS)
                                                       (RIGHT-HAND-ARTICULATION ?NS\:TEXAS-1 NS\:TEXAS)
                                                       (RIGHT-HAND-ARTICULATION ?IL-Y-A-4 IL-Y-A)
                                                       (RIGHT-HAND-ARTICULATION ?UN-1 UN)
                                                       (RIGHT-HAND-ARTICULATION ?VILLE-1 VILLE)
                                                       (RIGHT-HAND-ARTICULATION ?PLUS.P-6 PLUS.P)
                                                       (RIGHT-HAND-ARTICULATION ?GRAND.5-1 GRAND.5)
                                                       (RIGHT-HAND-ARTICULATION ?PT-30 PT)
                                                       (LOCATION ?PT-30 LEFT)
                                                       (RIGHT-HAND-ARTICULATION ?COMBIEN-7 COMBIEN)
                                                       (RIGHT-HAND-ARTICULATION ?METRE-CARRE-1 METRE-CARRE)
                                                       (RIGHT-HAND-ARTICULATION ?TAILLEUR-1 TAILLEUR)
                                                       (LEFT-HAND-ARTICULATION ?DANS-16 DANS)
                                                       (LEFT-HAND-ARTICULATION ?VILLE-2 VILLE)
                                                       (LEFT-HAND-ARTICULATION ?GRAND.5-2 GRAND.5)
                                                       (LEFT-HAND-ARTICULATION ?TAILLEUR-2 TAILLEUR)
                                                       (MEETS ?DANS-15 ?NS\:TEXAS-1)
                                                       (MEETS ?NS\:TEXAS-1 ?IL-Y-A-4)
                                                       (MEETS ?IL-Y-A-4 ?UN-1)
                                                       (MEETS ?UN-1 ?VILLE-1)
                                                       (MEETS ?VILLE-1 ?PLUS.P-6)
                                                       (MEETS ?PLUS.P-6 ?GRAND.5-1)
                                                       (MEETS ?GRAND.5-1 ?PT-30)
                                                       (MEETS ?PT-30 ?COMBIEN-7)
                                                       (MEETS ?COMBIEN-7 ?METRE-CARRE-1)
                                                       (MEETS ?METRE-CARRE-1 ?TAILLEUR-1)
                                                       (COINCIDES-RELATION ?DANS-15 ?DANS-16 EQUALS)
                                                       (MEETS ?UN-1 ?VILLE-2)
                                                       (COINCIDES-RELATION ?VILLE-1 ?VILLE-2 EQUALS)
                                                       (MEETS ?PLUS.P-6 ?GRAND.5-2)
                                                       (COINCIDES-RELATION ?GRAND.5-1 ?GRAND.5-2 EQUALS)
                                                       (MEETS ?METRE-CARRE-1 ?TAILLEUR-2)
                                                       (COINCIDES-RELATION ?TAILLEUR-1 ?TAILLEUR-2 EQUALS)))
                                             (:meaning . ((ANSWER ?D ?A ?E)
                                                          (SIZE ?E ?B ?A)
                                                          (LARGEST ?E ?B ?F)
                                                          (CITY ?F ?B)
                                                          (LOC ?F ?B ?C)
                                                          (CONST ?F ?C ?G)
                                                          (STATEID ?G ?H)
                                                          (TEXAS ?H)))))
(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *size-of-texas*))
                                                              (cdr (assoc :form  *size-of-largest-city-texas*))
                                                              :mode :shared-bindings))


;-------------------------
; Example 6: Addition
;-------------------------

(defparameter *major-cities-in-florida* '((:form . ((RIGHT-HAND-ARTICULATION #:DANS-19 DANS)
                                          (RIGHT-HAND-ARTICULATION ?PT-31 PT)
                                          (LOCATION ?PT-31 MIDDLE)
                                          (HANDSHAPE ?PT-31 \5)
                                          (ORIENTATION ?PT-31 DOWN-UP)
                                          (MOVEMENT ?PT-31 CIRCLE)
                                          (RIGHT-HAND-ARTICULATION ?NS\:FLORIDE-1 NS\:FLORIDE)
                                          (RIGHT-HAND-ARTICULATION ?DANS-20 DANS)
                                          (RIGHT-HAND-ARTICULATION ?IL-Y-A-5 IL-Y-A)
                                          (RIGHT-HAND-ARTICULATION ?GRAND.5-4 GRAND.5)
                                          (RIGHT-HAND-ARTICULATION ?VILLE-4 VILLE)
                                          (RIGHT-HAND-ARTICULATION ?COMBIEN-8 COMBIEN)
                                          (LEFT-HAND-ARTICULATION ?DANS-17 DANS)
                                          (LEFT-HAND-ARTICULATION ?DS-16 DS)
                                          (LOCATION ?DS-16 MIDDLE)
                                          (HANDSHAPE ?DS-16 \7)
                                          (ORIENTATION ?DS-16 DOWN-UP)
                                          (LEFT-HAND-ARTICULATION ?DANS-18 DANS)
                                          (LEFT-HAND-ARTICULATION ?GRAND.5-3 GRAND.5)
                                          (LEFT-HAND-ARTICULATION ?VILLE-3 VILLE)
                                          (MEETS ?DANS-19 ?PT-31)
                                          (MEETS ?PT-31 ?NS\:FLORIDE-1)
                                          (MEETS ?NS\:FLORIDE-1 ?DANS-20)
                                          (MEETS ?DANS-20 ?IL-Y-A-5)
                                          (MEETS ?IL-Y-A-5 ?GRAND.5-4)
                                          (MEETS ?GRAND.5-4 ?VILLE-4)
                                          (MEETS ?VILLE-4 ?COMBIEN-8)
                                          (COINCIDES-RELATION ?DANS-19 ?DANS-17 EQUALS)
                                          (MEETS ?DANS-19 ?DS-16)
                                          (COINCIDES-RELATION ?PT-31 ?DS-16 EQUALS)
                                          (MEETS ?NS\:FLORIDE-1 ?DANS-18)
                                          (COINCIDES-RELATION ?DANS-20 ?DANS-18 EQUALS)
                                          (MEETS ?IL-Y-A-5 ?GRAND.5-3)
                                          (COINCIDES-RELATION ?GRAND.5-4 ?GRAND.5-3 EQUALS)
                                          (MEETS ?GRAND.5-4 ?VILLE-3)
                                          (COINCIDES-RELATION ?VILLE-4 ?VILLE-3 EQUALS)))
                                (:meaning . ((ANSWER ?D ?A ?E)
                                             (COUNT ?E ?B ?F ?A)
                                             (MAJOR ?F ?B)
                                             (CITY ?F ?B)
                                             (LOC ?F ?B ?C)
                                             (CONST ?F ?C ?G)
                                             (STATEID ?G ?H)
                                             (FLORIDA ?H)))))

(defparameter *cities-in-florida* '((:form . ((RIGHT-HAND-ARTICULATION #:PT-32 PT)
                                              (LOCATION ?PT-32 MIDDLE)
                                              (HANDSHAPE ?PT-32 \5)
                                              (ORIENTATION ?PT-32 DOWN-UP)
                                              (MOVEMENT ?PT-32 CIRCLE)
                                              (RIGHT-HAND-ARTICULATION ?NS\:FLORIDE-3 NS\:FLORIDE)
                                              (RIGHT-HAND-ARTICULATION ?PT-33 PT)
                                              (MODIFICATION ?PT-33 REDUPLICATED)
                                              (LOCATION ?PT-33 MIDDLE)
                                              (RIGHT-HAND-ARTICULATION ?IL-Y-A-6 IL-Y-A)
                                              (RIGHT-HAND-ARTICULATION ?COMBIEN-9 COMBIEN)
                                              (RIGHT-HAND-ARTICULATION ?VILLE-6 VILLE)
                                              (LEFT-HAND-ARTICULATION ?DS-17 DS)
                                              (LOCATION ?DS-17 MIDDLE)
                                              (HANDSHAPE ?DS-17 \7)
                                              (ORIENTATION ?DS-17 DOWN-UP)
                                              (LEFT-HAND-ARTICULATION ?VILLE-5 VILLE)
                                              (MEETS ?PT-32 ?NS\:FLORIDE-3)
                                              (MEETS ?NS\:FLORIDE-3 ?PT-33)
                                              (MEETS ?PT-33 ?IL-Y-A-6)
                                              (MEETS ?IL-Y-A-6 ?COMBIEN-9)
                                              (MEETS ?COMBIEN-9 ?VILLE-6)
                                              (COINCIDES-RELATION ?PT-32 ?DS-17 STARTS)
                                              (COINCIDES-RELATION ?NS\:FLORIDE-3 ?DS-17 DURING)
                                              (COINCIDES-RELATION ?PT-33 ?DS-17 DURING)
                                              (COINCIDES-RELATION ?IL-Y-A-6 ?DS-17 DURING)
                                              (COINCIDES-RELATION ?COMBIEN-9 ?DS-17 FINISHES)
                                              (MEETS ?COMBIEN-9 ?VILLE-5)
                                              (COINCIDES-RELATION ?VILLE-6 ?VILLE-5 EQUALS)))
                                    (:meaning . ((ANSWER ?D ?A ?E)
                                                 (COUNT ?E ?B ?F ?A)
                                                 (CITY ?F ?B)
                                                 (LOC ?F ?B ?C)
                                                 (CONST ?F ?C ?G)
                                                 (STATEID ?G ?H)
                                                 (FLORIDA ?H)))))
(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *major-cities-in-florida*))
                                                              (cdr (assoc :form  *cities-in-florida*))
                                                              :mode :shared-bindings))

;-------------------------
; Example 7: substitution
;-------------------------
(defparameter *cities-in-us* '((:form . ((RIGHT-HAND-ARTICULATION ?NS\:AMERIQUE.FRITES-2 NS\:AMERIQUE.FRITES)
                                         (RIGHT-HAND-ARTICULATION ?PT-34 PT)
                                         (LOCATION ?PT-34 MIDDLE)
                                         (HANDSHAPE ?PT-34 \5)
                                         (ORIENTATION ?PT-34 DOWN-UP)
                                         (MOVEMENT ?PT-34 CIRCLE)
                                         (RIGHT-HAND-ARTICULATION ?IL-Y-A-7 IL-Y-A)
                                         (RIGHT-HAND-ARTICULATION ?COMBIEN-10 COMBIEN)
                                         (RIGHT-HAND-ARTICULATION ?VILLE-8 VILLE)
                                         (RIGHT-HAND-ARTICULATION ?PT-35 PT)
                                         (LOCATION ?PT-35 MIDDLE)
                                         (RIGHT-HAND-ARTICULATION ?COMBIEN-11 COMBIEN)
                                         (LEFT-HAND-ARTICULATION ?NS\:AMERIQUE.FRITES-1 NS\:AMERIQUE.FRITES)
                                         (LEFT-HAND-ARTICULATION ?DS-18 DS)
                                         (LOCATION ?DS-18 MIDDLE)
                                         (HANDSHAPE ?DS-18 \7)
                                         (ORIENTATION ?DS-18 DOWN-UP)
                                         (LEFT-HAND-ARTICULATION ?VILLE-7 VILLE)
                                         (LEFT-HAND-ARTICULATION ?DS-19 DS)
                                         (LOCATION ?DS-19 MIDDLE)
                                         (HANDSHAPE ?DS-19 \7)
                                         (ORIENTATION ?DS-19 DOWN-UP)
                                         (MEETS ?NS\:AMERIQUE.FRITES-2 ?PT-34)
                                         (MEETS ?PT-34 ?IL-Y-A-7)
                                         (MEETS ?IL-Y-A-7 ?COMBIEN-10)
                                         (MEETS ?COMBIEN-10 ?VILLE-8)
                                         (MEETS ?VILLE-8 ?PT-35)
                                         (MEETS ?PT-35 ?COMBIEN-11)
                                         (COINCIDES-RELATION ?NS\:AMERIQUE.FRITES-2 ?NS\:AMERIQUE.FRITES-1 EQUALS)
                                         (MEETS ?NS\:AMERIQUE.FRITES-2 ?DS-18)
                                         (COINCIDES-RELATION ?PT-34 ?DS-18 STARTS)
                                         (COINCIDES-RELATION ?IL-Y-A-7 ?DS-18 DURING)
                                         (COINCIDES-RELATION ?COMBIEN-10 ?DS-18 FINISHES)
                                         (MEETS ?COMBIEN-10 ?VILLE-7)
                                         (COINCIDES-RELATION ?VILLE-8 ?VILLE-7 EQUALS)
                                         (MEETS ?VILLE-8 ?DS-19)
                                         (COINCIDES-RELATION ?PT-35 ?DS-19 STARTS)
                                         (COINCIDES-RELATION ?COMBIEN-11 ?DS-19 FINISHES)))
                                    (:meaning . ((ANSWER ?D ?A ?E)
                                                 (COUNT ?E ?B ?F ?A)
                                                 (CITY ?F ?B)
                                                 (LOC ?F ?B ?C)
                                                 (CONST ?F ?C ?G)
                                                 (COUNTRYID ?G ?H)
                                                 (USA ?H)))))
(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *cities-in-us*))
                                                              (cdr (assoc :form  *cities-in-florida*))
                                                              :mode :shared-bindings))

;-------------------------
; Example 8: Substitution
;-------------------------

(defparameter *population-of-texas* '((:form . ((RIGHT-HAND-ARTICULATION ?DANS-22 DANS)
                                                (RIGHT-HAND-ARTICULATION ?PT-36 PT)
                                                (LOCATION ?PT-36 LEFT)
                                                (RIGHT-HAND-ARTICULATION ?NS\:TEXAS-1 NS\:TEXAS)
                                                (RIGHT-HAND-ARTICULATION ?PT-37 PT)
                                                (LOCATION ?PT-37 LEFT)
                                                (HANDSHAPE ?PT-37 \5)
                                                (ORIENTATION ?PT-37 DOWN-UP)
                                                (MOVEMENT ?PT-37 CIRCLE)
                                                (RIGHT-HAND-ARTICULATION ?PT-38 PT)
                                                (LOCATION ?PT-38 LEFT)
                                                (RIGHT-HAND-ARTICULATION ?COMBIEN-12 COMBIEN)
                                                (RIGHT-HAND-ARTICULATION ?HABITER-2 HABITER)
                                                (MODIFICATION ?HABITER-2 REDUPLICATED)
                                                (RIGHT-HAND-ARTICULATION ?PT-39 PT)
                                                (LOCATION ?PT-39 LEFT)
                                                (HANDSHAPE ?PT-39 \5)
                                                (ORIENTATION ?PT-39 DOWN-UP)
                                                (MOVEMENT ?PT-39 CIRCLE)
                                                (LEFT-HAND-ARTICULATION ?DANS-21 DANS)
                                                (LEFT-HAND-ARTICULATION ?DS-20 DS)
                                                (LOCATION ?DS-20 LEFT)
                                                (HANDSHAPE ?DS-20 \7)
                                                (ORIENTATION ?DS-20 DOWN-UP)
                                                (LEFT-HAND-ARTICULATION ?HABITER-1 HABITER)
                                                (MODIFICATION ?HABITER-1 REDUPLICATED)
                                                (LEFT-HAND-ARTICULATION ?DS-21 DS)
                                                (LOCATION ?DS-21 LEFT)
                                                (HANDSHAPE ?DS-21 \7)
                                                (ORIENTATION ?DS-21 DOWN-UP)
                                                (MEETS ?DANS-22 ?PT-36)
                                                (MEETS ?PT-36 ?NS\:TEXAS-1)
                                                (MEETS ?NS\:TEXAS-1 ?PT-37)
                                                (MEETS ?PT-37 ?PT-38)
                                                (MEETS ?PT-38 ?COMBIEN-12)
                                                (MEETS ?COMBIEN-12 ?HABITER-2)
                                                (MEETS ?HABITER-2 ?PT-39)
                                                (COINCIDES-RELATION ?DANS-22 ?DANS-21 EQUALS)
                                                (MEETS ?NS\:TEXAS-1 ?DS-20)
                                                (COINCIDES-RELATION ?PT-37 ?DS-20 STARTS)
                                                (COINCIDES-RELATION ?PT-38 ?DS-20 FINISHES)
                                                (MEETS ?COMBIEN-12 ?HABITER-1)
                                                (COINCIDES-RELATION ?HABITER-2 ?HABITER-1 EQUALS)
                                                (MEETS ?HABITER-2 ?DS-21)
                                                (COINCIDES-RELATION ?PT-39 ?DS-21 EQUALS)))
                                      (:meaning . ((ANSWER ?C ?A ?D)
                                                   (POPULATION ?D ?B ?A)
                                                   (CONST ?D ?B ?E)
                                                   (STATEID ?E ?F)
                                                   (ALABAMA ?F)))))


(au-benchmark.msg.kswap-omega::print-anti-unification-results 
 (au-benchmark.msg.kswap-omega::anti-unify-predicate-networks (cdr (assoc :form *size-of-texas*))
                                                              (cdr (assoc :form  *population-of-texas*))
                                                              :mode :shared-bindings))

|#
