(in-package :geoquery-lsfb)

(defun make-geoquery-lsfb-grammar ()
  (let* ((grammar-name (make-const "geoquery-lsfb-grammar"))
         (cxn-inventory (read-from-string (format nil "*~a*" (string grammar-name)))))
    (eval
     `(def-fcg-constructions ,grammar-name
      :feature-types ((subunits set)
                      (args set)
                      (footprints set)
                      (form set-of-predicates)
                      (meaning set-of-predicates))
      :hierarchy-features (subunits)
      :diagnostics ()
      :repairs ()
      :cxn-inventory cxn-inventory
      :fcg-configurations ((:parse-goal-tests :no-applicable-cxns)
                           (:production-goal-tests :no-applicable-cxns)
                           (:node-tests :check-duplicate :restrict-nr-of-nodes :restrict-search-depth)
                           (:max-number-of-nodes . 200)
                           (:max-search-depth . 50)
                           (:render-mode . :set-of-predicates)
                           (:de-render-mode . :set-of-predicates)
                           (:shuffle-cxns-before-application . t)
                           (:draw-meaning-as-network . t)
                           (:construction-inventory-processor-mode . :heuristic-search)
                           (:node-expansion-mode . :full-expansion)
                           (:search-algorithm . :best-first)
                           (:heuristic-value-mode . :sum-heuristics-and-parent)
                           (:cxn-supplier-mode . :all-cxns)
                           (:heuristics :nr-of-applied-cxns))
      
      :visualization-configurations ((:with-search-debug-data . t)
                                     (:remove-empty-units . nil)
                                     (:show-constructional-dependencies . t)
                                     (:labeled-paths . nil)
                                     (:colored-paths . nil)
                                     (:hide-features . nil)
                                     (:hierarchy-features subunits)
                                     (:selected-hierarchy . subunits)
                                     (:select-subfeatures . nil))))))
